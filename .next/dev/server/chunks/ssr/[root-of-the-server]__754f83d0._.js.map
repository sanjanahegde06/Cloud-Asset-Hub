{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///D:/cloud-asset-hub/lib/supabaseClient.js"],"sourcesContent":["import { createClient } from '@supabase/supabase-js'\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey)"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AACN,MAAM;AAEC,MAAM,WAAW,IAAA,iKAAY,EAAC,aAAa","debugId":null}},
    {"offset": {"line": 47, "column": 0}, "map": {"version":3,"sources":["file:///D:/cloud-asset-hub/components/ProtectedRoute.js"],"sourcesContent":["import { useEffect } from 'react';\nimport { useRouter } from 'next/router';\nimport { supabase } from '../lib/supabaseClient';\n\nexport default function ProtectedRoute({ children }) {\n  const router = useRouter();\n\n  useEffect(() => {\n    const checkUser = async () => {\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session) {\n        router.push('/');\n      }\n    };\n\n    const { data: { subscription } } = supabase.auth.onAuthStateChange((event, session) => {\n      if (!session) {\n        router.push('/');\n      }\n    });\n\n    checkUser();\n    return () => subscription.unsubscribe();\n  }, [router]);\n\n  return <>{children}</>;\n}"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;AAEe,SAAS,eAAe,EAAE,QAAQ,EAAE;IACjD,MAAM,SAAS,IAAA,oIAAS;IAExB,IAAA,gHAAS,EAAC;QACR,MAAM,YAAY;YAChB,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,GAAG,MAAM,0HAAQ,CAAC,IAAI,CAAC,UAAU;YAC5D,IAAI,CAAC,SAAS;gBACZ,OAAO,IAAI,CAAC;YACd;QACF;QAEA,MAAM,EAAE,MAAM,EAAE,YAAY,EAAE,EAAE,GAAG,0HAAQ,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,OAAO;YACzE,IAAI,CAAC,SAAS;gBACZ,OAAO,IAAI,CAAC;YACd;QACF;QAEA;QACA,OAAO,IAAM,aAAa,WAAW;IACvC,GAAG;QAAC;KAAO;IAEX,qBAAO;kBAAG;;AACZ","debugId":null}},
    {"offset": {"line": 86, "column": 0}, "map": {"version":3,"sources":["file:///D:/cloud-asset-hub/components/UploadForm.js"],"sourcesContent":["import { useState } from 'react';\nimport { supabase } from '../lib/supabaseClient';\n\nexport default function UploadForm({ onUploadComplete }) {\n  const [uploading, setUploading] = useState(false);\n  const [error, setError] = useState(null);\n  const [progressMessage, setProgressMessage] = useState('');\n  \n  // State to hold the actual file object\n  const [file, setFile] = useState(null); \n  // State to display the file name to the user\n  const [selectedFileName, setSelectedFileName] = useState('No file chosen');\n\n  // New function to handle file selection (just updates state)\n  const handleFileChange = (e) => {\n    const selectedFile = e.target.files?.[0];\n    setFile(selectedFile);\n    setSelectedFileName(selectedFile ? selectedFile.name : 'No file chosen');\n    setError(null);\n  };\n\n  // Modified function to handle the actual upload when the submit button is clicked\n  const handleSubmission = async (e) => {\n    e.preventDefault(); // Prevent default form submission\n\n    if (!file) {\n      setError('Please select a file to upload.');\n      return;\n    }\n\n    try {\n      setUploading(true);\n      setError(null);\n      setProgressMessage('Preparing upload...');\n\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session?.user) throw new Error('Not authenticated');\n\n      const filePath = `${session.user.id}/${Date.now()}-${file.name}`;\n\n      setProgressMessage('Uploading...');\n      \n      // Use the file object from state for the upload\n      const { error: uploadError } = await supabase.storage.from('uploads').upload(filePath, file, {\n        cacheControl: '3600',\n        upsert: false,\n      });\n\n      if (uploadError) throw uploadError;\n\n      setProgressMessage('Upload complete');\n      \n      // Reset form states\n      setFile(null);\n      setSelectedFileName('No file chosen');\n      \n      if (onUploadComplete) await onUploadComplete();\n\n    } catch (err) {\n      setError(err?.message || String(err));\n      setProgressMessage('');\n    } finally {\n      setUploading(false);\n      setTimeout(() => setProgressMessage(''), 2500);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmission}> {/* Use a form element for submission */}\n      <div className=\"file-upload-container\">\n        {/* 1. The actual, hidden file input */}\n        <input \n          type=\"file\" \n          id=\"file-upload-input\" \n          onChange={handleFileChange} \n          disabled={uploading}\n        />\n\n        {/* 2. The custom, styled Choose File button (Label targets the input's ID) */}\n        <label htmlFor=\"file-upload-input\" className=\"file-upload-label\" aria-disabled={uploading}>\n          Choose File\n        </label>\n\n        {/* 3. The display element */}\n        <div className=\"file-name-display\">\n          {selectedFileName}\n        </div>\n        \n        {/* 4. The separate Upload action button */}\n        <button \n          type=\"submit\" \n          className=\"btn ghost\" \n          disabled={!file || uploading}\n        >\n          {uploading ? 'Uploading...' : 'Upload'}\n        </button>\n      </div>\n\n      {(uploading || progressMessage) && <p className=\"muted\">{progressMessage || 'Processing...'}</p>}\n      {error && <p className=\"error\">{error}</p>}\n    </form>\n  );\n}"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAEe,SAAS,WAAW,EAAE,gBAAgB,EAAE;IACrD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,+GAAQ,EAAC;IAC3C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,+GAAQ,EAAC;IACnC,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,+GAAQ,EAAC;IAEvD,uCAAuC;IACvC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,+GAAQ,EAAC;IACjC,6CAA6C;IAC7C,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,+GAAQ,EAAC;IAEzD,6DAA6D;IAC7D,MAAM,mBAAmB,CAAC;QACxB,MAAM,eAAe,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE;QACxC,QAAQ;QACR,oBAAoB,eAAe,aAAa,IAAI,GAAG;QACvD,SAAS;IACX;IAEA,kFAAkF;IAClF,MAAM,mBAAmB,OAAO;QAC9B,EAAE,cAAc,IAAI,kCAAkC;QAEtD,IAAI,CAAC,MAAM;YACT,SAAS;YACT;QACF;QAEA,IAAI;YACF,aAAa;YACb,SAAS;YACT,mBAAmB;YAEnB,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,GAAG,MAAM,0HAAQ,CAAC,IAAI,CAAC,UAAU;YAC5D,IAAI,CAAC,SAAS,MAAM,MAAM,IAAI,MAAM;YAEpC,MAAM,WAAW,GAAG,QAAQ,IAAI,CAAC,EAAE,CAAC,CAAC,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,IAAI,EAAE;YAEhE,mBAAmB;YAEnB,gDAAgD;YAChD,MAAM,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,0HAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,MAAM,CAAC,UAAU,MAAM;gBAC3F,cAAc;gBACd,QAAQ;YACV;YAEA,IAAI,aAAa,MAAM;YAEvB,mBAAmB;YAEnB,oBAAoB;YACpB,QAAQ;YACR,oBAAoB;YAEpB,IAAI,kBAAkB,MAAM;QAE9B,EAAE,OAAO,KAAK;YACZ,SAAS,KAAK,WAAW,OAAO;YAChC,mBAAmB;QACrB,SAAU;YACR,aAAa;YACb,WAAW,IAAM,mBAAmB,KAAK;QAC3C;IACF;IAEA,qBACE,qKAAC;QAAK,UAAU;;YAAkB;0BAChC,qKAAC;gBAAI,WAAU;;kCAEb,qKAAC;wBACC,MAAK;wBACL,IAAG;wBACH,UAAU;wBACV,UAAU;;;;;;kCAIZ,qKAAC;wBAAM,SAAQ;wBAAoB,WAAU;wBAAoB,iBAAe;kCAAW;;;;;;kCAK3F,qKAAC;wBAAI,WAAU;kCACZ;;;;;;kCAIH,qKAAC;wBACC,MAAK;wBACL,WAAU;wBACV,UAAU,CAAC,QAAQ;kCAElB,YAAY,iBAAiB;;;;;;;;;;;;YAIjC,CAAC,aAAa,eAAe,mBAAK,qKAAC;gBAAE,WAAU;0BAAS,mBAAmB;;;;;;YAC3E,uBAAS,qKAAC;gBAAE,WAAU;0BAAS;;;;;;;;;;;;AAGtC","debugId":null}},
    {"offset": {"line": 223, "column": 0}, "map": {"version":3,"sources":["file:///D:/cloud-asset-hub/components/PreviewModal.js"],"sourcesContent":["import React, { useEffect } from 'react'\r\n\r\nexport default function PreviewModal({ open, url, type, name, full = false, onClose }) {\r\n  useEffect(() => {\r\n    if (!open) return\r\n    const onKey = (e) => {\r\n      if (e.key === 'Escape') onClose()\r\n    }\r\n    window.addEventListener('keydown', onKey)\r\n    return () => window.removeEventListener('keydown', onKey)\r\n  }, [open, onClose])\r\n\r\n  if (!open) return null\r\n\r\n  const renderContent = () => {\r\n    if (!url) return <p>Preview not available.</p>\r\n    if (type?.startsWith('image/')) {\r\n      return <img src={url} alt={name} style={{ width: '100%', height: '100%', objectFit: 'contain' }} />\r\n    }\r\n    if (type === 'application/pdf') {\r\n      return <iframe src={url} style={{ width: '100%', height: '100%', border: 'none' }} title={name} />\r\n    }\r\n    return <iframe src={url} style={{ width: '100%', height: '100%', border: 'none' }} title={name} />\r\n  }\r\n\r\n  return (\r\n    <div className=\"preview-modal-backdrop\" onClick={onClose}>\r\n      <div\r\n        className={`preview-modal ${full ? 'preview-full' : ''}`}\r\n        onClick={(e) => e.stopPropagation()}\r\n        role=\"dialog\"\r\n        aria-modal=\"true\"\r\n        aria-label={`Preview ${name}`}\r\n      >\r\n        <header className=\"preview-header\">\r\n          <strong>{name}</strong>\r\n          <button onClick={onClose} className=\"close-btn\">Close</button>\r\n        </header>\r\n        <div className=\"preview-body\">\r\n          {renderContent()}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAAA;;;AAEe,SAAS,aAAa,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,OAAO,KAAK,EAAE,OAAO,EAAE;IACnF,IAAA,gHAAS,EAAC;QACR,IAAI,CAAC,MAAM;QACX,MAAM,QAAQ,CAAC;YACb,IAAI,EAAE,GAAG,KAAK,UAAU;QAC1B;QACA,OAAO,gBAAgB,CAAC,WAAW;QACnC,OAAO,IAAM,OAAO,mBAAmB,CAAC,WAAW;IACrD,GAAG;QAAC;QAAM;KAAQ;IAElB,IAAI,CAAC,MAAM,OAAO;IAElB,MAAM,gBAAgB;QACpB,IAAI,CAAC,KAAK,qBAAO,qKAAC;sBAAE;;;;;;QACpB,IAAI,MAAM,WAAW,WAAW;YAC9B,qBAAO,qKAAC;gBAAI,KAAK;gBAAK,KAAK;gBAAM,OAAO;oBAAE,OAAO;oBAAQ,QAAQ;oBAAQ,WAAW;gBAAU;;;;;;QAChG;QACA,IAAI,SAAS,mBAAmB;YAC9B,qBAAO,qKAAC;gBAAO,KAAK;gBAAK,OAAO;oBAAE,OAAO;oBAAQ,QAAQ;oBAAQ,QAAQ;gBAAO;gBAAG,OAAO;;;;;;QAC5F;QACA,qBAAO,qKAAC;YAAO,KAAK;YAAK,OAAO;gBAAE,OAAO;gBAAQ,QAAQ;gBAAQ,QAAQ;YAAO;YAAG,OAAO;;;;;;IAC5F;IAEA,qBACE,qKAAC;QAAI,WAAU;QAAyB,SAAS;kBAC/C,cAAA,qKAAC;YACC,WAAW,CAAC,cAAc,EAAE,OAAO,iBAAiB,IAAI;YACxD,SAAS,CAAC,IAAM,EAAE,eAAe;YACjC,MAAK;YACL,cAAW;YACX,cAAY,CAAC,QAAQ,EAAE,MAAM;;8BAE7B,qKAAC;oBAAO,WAAU;;sCAChB,qKAAC;sCAAQ;;;;;;sCACT,qKAAC;4BAAO,SAAS;4BAAS,WAAU;sCAAY;;;;;;;;;;;;8BAElD,qKAAC;oBAAI,WAAU;8BACZ;;;;;;;;;;;;;;;;;AAKX","debugId":null}},
    {"offset": {"line": 355, "column": 0}, "map": {"version":3,"sources":["file:///D:/cloud-asset-hub/components/FileList.js"],"sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { supabase } from '../lib/supabaseClient'\nimport PreviewModal from './PreviewModal'\n\nexport default function FileList({ files = [], onDelete, onRefresh }) {\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState(null)\n  const [preview, setPreview] = useState({ open: false, url: '', type: '', name: '', full: false })\n\n  // sorting state\n  const [sortBy, setSortBy] = useState('name') // 'name' | 'size' | 'ext' | 'date'\n  const [sortDir, setSortDir] = useState('asc') // 'asc' | 'desc'\n\n  // sanitize and dedupe by name to avoid double entries and undefined items\n  const sanitizedFiles = Array.from(\n    new Map(\n      (files || [])\n        .filter(Boolean)\n        .filter(f => typeof f.name === 'string')\n        .map((f) => [f.name, f])\n    ).values()\n  ).map(f => ({\n    // normalize common fields we use for sorting / display\n    ...f,\n    _size: Number(f.size || f.metadata?.size || 0) || 0,\n    _ext: (f.name || '').split('.').pop()?.toLowerCase() || '',\n    _date: new Date(f.updated_at || f.created_at || 0).getTime() || 0,\n  }))\n\n  const getMimeFromName = (name = '') => {\n    const ext = name.split('.').pop()?.toLowerCase() || ''\n    if (['png', 'jpg', 'jpeg', 'gif', 'webp'].includes(ext)) return `image/${ext === 'jpg' ? 'jpeg' : ext}`\n    if (ext === 'pdf') return 'application/pdf'\n    if (['txt', 'md'].includes(ext)) return 'text/plain'\n    return 'application/octet-stream'\n  }\n\n  const handleDelete = async (fileName) => {\n    if (!fileName) return\n    try {\n      setLoading(true)\n      setError(null)\n\n      const { data: { session } } = await supabase.auth.getSession()\n      if (!session?.user) throw new Error('Not authenticated')\n\n      const filePath = `${session.user.id}/${fileName}`\n      const { error } = await supabase.storage.from('uploads').remove([filePath])\n      if (error) throw error\n\n      if (onDelete) onDelete(fileName)\n      if (onRefresh) onRefresh()\n    } catch (err) {\n      setError(err?.message || String(err))\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleDownload = async (fileName) => {\n    if (!fileName) return\n    try {\n      setLoading(true)\n      setError(null)\n\n      const { data: { session } } = await supabase.auth.getSession()\n      if (!session?.user) throw new Error('Not authenticated')\n\n      const filePath = `${session.user.id}/${fileName}`\n      const { data, error } = await supabase.storage.from('uploads').download(filePath)\n      if (error) throw error\n\n      const url = window.URL.createObjectURL(data)\n      const a = document.createElement('a')\n      a.href = url\n      a.download = fileName\n      document.body.appendChild(a)\n      a.click()\n      document.body.removeChild(a)\n      window.URL.revokeObjectURL(url)\n    } catch (err) {\n      setError(err?.message || String(err))\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleView = async (file) => {\n    if (!file || !file.name) return\n    try {\n      setLoading(true)\n      setError(null)\n\n      const { data: { session } } = await supabase.auth.getSession()\n      if (!session?.user) throw new Error('Not authenticated')\n      const filePath = `${session.user.id}/${file.name}`\n\n      const { data: signedData, error: signedErr } = await supabase.storage\n        .from('uploads')\n        .createSignedUrl(filePath, 60)\n\n      if (signedErr || !signedData?.signedURL) {\n        const { data, error } = await supabase.storage.from('uploads').download(filePath)\n        if (error) throw error\n        const url = window.URL.createObjectURL(data)\n        const type = data.type || (file.metadata?.mimetype) || getMimeFromName(file.name)\n        // open full-screen preview for images/pdf and blob fallback\n        setPreview({ open: true, url, type, name: file.name, full: true })\n        return\n      }\n\n      const url = signedData.signedURL\n      let contentType = ''\n      try {\n        const head = await fetch(url, { method: 'HEAD' })\n        contentType = head.headers.get('content-type') || ''\n      } catch (e) {\n        // ignore\n      }\n\n      const type = contentType || file.metadata?.mimetype || getMimeFromName(file.name)\n\n      if (type.startsWith('image/') || type === 'application/pdf') {\n        setPreview({ open: true, url, type, name: file.name, full: true })\n      } else {\n        window.open(url, '_blank', 'noopener')\n      }\n    } catch (err) {\n      setError(err?.message || String(err))\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  // helpers for sorting\n  const compareStrings = (a = '', b = '') => a.localeCompare(b)\n  const sortedFiles = [...sanitizedFiles].sort((a, b) => {\n    let av, bv\n    switch (sortBy) {\n      case 'size':\n        av = a._size; bv = b._size; break\n      case 'ext':\n        av = a._ext; bv = b._ext; break\n      case 'date':\n        av = a._date; bv = b._date; break\n      default:\n        av = (a.name || '').toLowerCase(); bv = (b.name || '').toLowerCase()\n    }\n\n    // string compare\n    if (typeof av === 'string' && typeof bv === 'string') {\n      const cmp = compareStrings(av, bv)\n      return sortDir === 'asc' ? cmp : -cmp\n    }\n\n    // numeric compare\n    const cmpN = (av || 0) - (bv || 0)\n    return sortDir === 'asc' ? cmpN : -cmpN\n  })\n\n  const toggleSortDir = () => setSortDir(d => (d === 'asc' ? 'desc' : 'asc'))\n\n  const humanBytes = (bytes) => {\n    const b = Number(bytes) || 0\n    if (b === 0) return ''\n    const units = ['B', 'KB', 'MB', 'GB', 'TB']\n    let i = 0\n    let val = b\n    while (val >= 1024 && i < units.length - 1) {\n      val /= 1024\n      i++\n    }\n    return `${val.toFixed(val >= 100 ? 0 : 1)} ${units[i]}`\n  }\n\n  if (!sortedFiles.length) {\n    return <p className=\"muted\">No files uploaded yet.</p>\n  }\n\n  return (\n    <div className=\"file-list\">\n      {error && <p className=\"error\">{error}</p>}\n\n      <div className=\"file-list-controls\">\n        <label style={{ fontSize: '1.4rem' }}>\n          Sort by:&nbsp;\n          <select value={sortBy} onChange={(e) => setSortBy(e.target.value)}>\n            <option value=\"name\">Alphabet</option>\n            <option value=\"size\">Size</option>\n            <option value=\"ext\">Letters (extension)</option>\n            <option value=\"date\">Date</option>\n          </select>\n        </label>\n\n        <button className=\"sort-dir-btn\" onClick={toggleSortDir} aria-label=\"Toggle sort direction\">\n          {sortDir === 'asc' ? '↑' : '↓'}\n        </button>\n      </div>\n\n      <ul>\n        {sortedFiles.map((file) => (\n          <li key={file.name}>\n            <div className=\"file-meta\">\n              <strong className=\"file-name\">{file.name}</strong>\n              {file.updated_at && <span className=\"file-time\">{new Date(file.updated_at).toLocaleString()}</span>}\n              <small style={{ color: '#6b7280', marginTop: 6 }}>\n                {file._size ? humanBytes(file._size) : ''}\n              </small>\n            </div>\n\n            <div className=\"actions\">\n              <button onClick={() => handleView(file)} disabled={loading}>View</button>\n              <button onClick={() => handleDownload(file.name)} disabled={loading}>Download</button>\n              <button onClick={() => handleDelete(file.name)} disabled={loading} className=\"delete\">Delete</button>\n            </div>\n          </li>\n        ))}\n      </ul>\n\n      <PreviewModal\n        open={preview.open}\n        url={preview.url}\n        type={preview.type}\n        name={preview.name}\n        full={preview.full}\n        onClose={() => {\n          if (preview.url && preview.url.startsWith('blob:')) {\n            window.URL.revokeObjectURL(preview.url)\n          }\n          setPreview({ open: false, url: '', type: '', name: '', full: false })\n        }}\n      />\n    </div>\n  )\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 771, "column": 0}, "map": {"version":3,"sources":["file:///D:/cloud-asset-hub/pages/dashboard.js"],"sourcesContent":["// index.js (Dashboard)\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/router';\nimport Link from 'next/link';\nimport { supabase } from '../lib/supabaseClient';\nimport ProtectedRoute from '../components/ProtectedRoute';\nimport UploadForm from '../components/UploadForm';\nimport FileList from '../components/FileList';\n\nexport default function Dashboard() {\n  const [files, setFiles] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [user, setUser] = useState(null);\n  const router = useRouter();\n\n  const fetchUser = async () => {\n    const { data } = await supabase.auth.getUser();\n    setUser(data?.user ?? data);\n  };\n\n  async function fetchFiles() {\n    try {\n      setLoading(true);\n      setError(null);\n\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session?.user) {\n        setFiles([]);\n        return;\n      }\n\n      const res = await supabase.storage.from('uploads').list(session.user.id);\n      console.debug('supabase.storage.list response:', res);\n\n      if (res.error) throw res.error;\n      const sanitized = (res.data || [])\n        .filter(Boolean)\n        .filter(f => typeof f.name === 'string')\n        .sort((a, b) => (b.updated_at || 0) - (a.updated_at || 0));\n\n      setFiles(sanitized);\n    } catch (err) {\n      setError(err?.message || String(err));\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  useEffect(() => {\n    fetchUser();\n    fetchFiles();\n  }, []);\n\n  const handleLogout = async () => {\n    await supabase.auth.signOut();\n    router.push('/');\n  };\n\n  const totalFiles = (files || []).length;\n\n  return (\n    <ProtectedRoute>\n      <div className=\"dashboard\">\n        <header className=\"dashboard-header\">\n          <h1>☁️ Cloud Asset Hub</h1>\n\n          <nav className=\"dashboard-nav\">\n            <Link href=\"/profile\">\n              <button className=\"btn ghost\" aria-label=\"Profile\">Profile</button>\n            </Link>\n\n            <button\n              className=\"btn ghost\"\n              onClick={handleLogout}\n              style={{ marginLeft: '1rem' }}\n              aria-label=\"Logout\"\n            >\n              Logout\n            </button>\n          </nav>\n        </header>\n\n        <div className=\"grid\">\n          <main className=\"main-panel\" style={{ width: '100%' }}>\n            <section className=\"upload-section card\">\n              <h2>Upload Files</h2>\n              <UploadForm onUploadComplete={fetchFiles} />\n            </section>\n\n            <section className=\"files-section card\">\n              <h2>Your Documents</h2>\n              {loading ? (\n                <p className=\"muted\">Loading...</p>\n              ) : error ? (\n                <p className=\"error\">{error}</p>\n              ) : (\n                <FileList files={files} onDelete={() => fetchFiles()} onRefresh={fetchFiles} />\n              )}\n            </section>\n          </main>\n        </div>\n      </div>\n    </ProtectedRoute>\n  );\n}"],"names":[],"mappings":"AAAA,uBAAuB;;;;;;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AAEe,SAAS;IACtB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,+GAAQ,EAAC,EAAE;IACrC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+GAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,+GAAQ,EAAC;IACnC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,+GAAQ,EAAC;IACjC,MAAM,SAAS,IAAA,oIAAS;IAExB,MAAM,YAAY;QAChB,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,0HAAQ,CAAC,IAAI,CAAC,OAAO;QAC5C,QAAQ,MAAM,QAAQ;IACxB;IAEA,eAAe;QACb,IAAI;YACF,WAAW;YACX,SAAS;YAET,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,GAAG,MAAM,0HAAQ,CAAC,IAAI,CAAC,UAAU;YAC5D,IAAI,CAAC,SAAS,MAAM;gBAClB,SAAS,EAAE;gBACX;YACF;YAEA,MAAM,MAAM,MAAM,0HAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,IAAI,CAAC,QAAQ,IAAI,CAAC,EAAE;YACvE,QAAQ,KAAK,CAAC,mCAAmC;YAEjD,IAAI,IAAI,KAAK,EAAE,MAAM,IAAI,KAAK;YAC9B,MAAM,YAAY,CAAC,IAAI,IAAI,IAAI,EAAE,EAC9B,MAAM,CAAC,SACP,MAAM,CAAC,CAAA,IAAK,OAAO,EAAE,IAAI,KAAK,UAC9B,IAAI,CAAC,CAAC,GAAG,IAAM,CAAC,EAAE,UAAU,IAAI,CAAC,IAAI,CAAC,EAAE,UAAU,IAAI,CAAC;YAE1D,SAAS;QACX,EAAE,OAAO,KAAK;YACZ,SAAS,KAAK,WAAW,OAAO;QAClC,SAAU;YACR,WAAW;QACb;IACF;IAEA,IAAA,gHAAS,EAAC;QACR;QACA;IACF,GAAG,EAAE;IAEL,MAAM,eAAe;QACnB,MAAM,0HAAQ,CAAC,IAAI,CAAC,OAAO;QAC3B,OAAO,IAAI,CAAC;IACd;IAEA,MAAM,aAAa,CAAC,SAAS,EAAE,EAAE,MAAM;IAEvC,qBACE,qKAAC,gIAAc;kBACb,cAAA,qKAAC;YAAI,WAAU;;8BACb,qKAAC;oBAAO,WAAU;;sCAChB,qKAAC;sCAAG;;;;;;sCAEJ,qKAAC;4BAAI,WAAU;;8CACb,qKAAC,gIAAI;oCAAC,MAAK;8CACT,cAAA,qKAAC;wCAAO,WAAU;wCAAY,cAAW;kDAAU;;;;;;;;;;;8CAGrD,qKAAC;oCACC,WAAU;oCACV,SAAS;oCACT,OAAO;wCAAE,YAAY;oCAAO;oCAC5B,cAAW;8CACZ;;;;;;;;;;;;;;;;;;8BAML,qKAAC;oBAAI,WAAU;8BACb,cAAA,qKAAC;wBAAK,WAAU;wBAAa,OAAO;4BAAE,OAAO;wBAAO;;0CAClD,qKAAC;gCAAQ,WAAU;;kDACjB,qKAAC;kDAAG;;;;;;kDACJ,qKAAC,4HAAU;wCAAC,kBAAkB;;;;;;;;;;;;0CAGhC,qKAAC;gCAAQ,WAAU;;kDACjB,qKAAC;kDAAG;;;;;;oCACH,wBACC,qKAAC;wCAAE,WAAU;kDAAQ;;;;;+CACnB,sBACF,qKAAC;wCAAE,WAAU;kDAAS;;;;;6DAEtB,qKAAC,0HAAQ;wCAAC,OAAO;wCAAO,UAAU,IAAM;wCAAc,WAAW;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQjF","debugId":null}}]
}